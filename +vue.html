<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vue寻宝冒险游戏</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #1a2a6c, #b21f1f, #fdbb2d);
            color: #fff;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        /* 导航栏样式 */
        .navbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 15px;
            padding: 15px 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .nav-brand {
            font-size: 1.8rem;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .nav-links {
            display: flex;
            gap: 20px;
        }

        .nav-link {
            padding: 10px 20px;
            border-radius: 50px;
            cursor: pointer;
            transition: background 0.3s;
        }

        .nav-link.active {
            background: rgba(255, 255, 255, 0.2);
        }

        .nav-link:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(90deg, #ff8a00, #e52e71);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }

        /* 页面容器样式 */
        .page-container {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            min-height: 600px;
        }

        /* 游戏区域样式 */
        .game-area {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .progress-container {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            padding: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .progress-bar {
            height: 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 10px;
        }

        .progress {
            height: 100%;
            background: linear-gradient(90deg, #ff8a00, #e52e71);
            width: 0%;
            transition: width 0.5s ease;
            border-radius: 10px;
        }

        .progress-text {
            text-align: center;
            font-weight: bold;
        }

        .steps-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .step-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            transition: transform 0.3s ease, background 0.3s ease;
            min-height: 200px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .step-card.active {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
        }

        .step-card.completed {
            background: rgba(46, 204, 113, 0.2);
        }

        .step-card.failed {
            background: rgba(231, 76, 60, 0.2);
        }

        .step-header {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }

        .step-icon {
            width: 40px;
            height: 40px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            font-weight: bold;
        }

        .step-title {
            font-size: 1.3rem;
            font-weight: bold;
        }

        .step-content {
            flex-grow: 1;
            margin-bottom: 15px;
            line-height: 1.5;
        }

        .step-status {
            font-style: italic;
            text-align: center;
            padding: 5px;
            border-radius: 5px;
            background: rgba(0, 0, 0, 0.2);
        }

        .controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
        }

        button {
            padding: 12px 25px;
            border: none;
            border-radius: 50px;
            background: linear-gradient(90deg, #ff8a00, #e52e71);
            color: white;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        button:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
        }

        button:active {
            transform: translateY(1px);
        }

        button:disabled {
            background: rgba(255, 255, 255, 0.2);
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .treasure-result {
            text-align: center;
            padding: 30px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 15px;
            margin-top: 20px;
            animation: fadeIn 1s ease;
        }

        .treasure-image {
            font-size: 5rem;
            margin-bottom: 20px;
            animation: bounce 2s infinite;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }

        @keyframes bounce {

            0%,
            100% {
                transform: translateY(0);
            }

            50% {
                transform: translateY(-20px);
            }
        }

        .event-log {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            padding: 15px;
            margin-top: 20px;
            max-height: 200px;
            overflow-y: auto;
        }

        .event-log h3 {
            margin-bottom: 10px;
            text-align: center;
        }

        .log-entry {
            padding: 5px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            font-size: 0.9rem;
        }

        .log-entry:last-child {
            border-bottom: none;
        }

        /* 用户管理页面样式 */
        .user-management {
            max-width: 500px;
            margin: 0 auto;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
        }

        .form-group input {
            width: 100%;
            padding: 12px 15px;
            border-radius: 10px;
            border: none;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 1rem;
        }

        .form-group input:focus {
            outline: none;
            background: rgba(255, 255, 255, 0.2);
        }

        .user-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 20px;
            text-align: center;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .stat-label {
            font-size: 0.9rem;
            opacity: 0.8;
        }

        /* 排行榜页面样式 */
        .leaderboard {
            max-width: 800px;
            margin: 0 auto;
        }

        .leaderboard-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .leaderboard-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .leaderboard-item {
            display: flex;
            align-items: center;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 15px 20px;
            transition: transform 0.2s;
        }

        .leaderboard-item:hover {
            transform: translateY(-3px);
            background: rgba(255, 255, 255, 0.15);
        }

        .leaderboard-rank {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-right: 15px;
        }

        .leaderboard-user {
            flex-grow: 1;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .leaderboard-score {
            font-weight: bold;
            font-size: 1.2rem;
        }

        .top-1 .leaderboard-rank {
            background: linear-gradient(90deg, #ffd700, #ff8a00);
        }

        .top-2 .leaderboard-rank {
            background: linear-gradient(90deg, #c0c0c0, #a0a0a0);
        }

        .top-3 .leaderboard-rank {
            background: linear-gradient(90deg, #cd7f32, #a56a2a);
        }

        @media (max-width: 768px) {
            .steps-container {
                grid-template-columns: 1fr;
            }

            .navbar {
                flex-direction: column;
                gap: 15px;
            }

            .nav-links {
                width: 100%;
                justify-content: center;
            }
        }
    </style>
</head>

<body>
    <div id="app"></div>

    <script>
        const { createApp, ref, computed, onMounted } = Vue;

        // 模拟宝藏地图API
        class TreasureMap {
            static getInitialClue() {
                return new Promise((resolve) => {
                    setTimeout(() => {
                        resolve("在古老的图书馆里找到了第一个线索：一张泛黄的地图，上面标记着'月光神庙'的位置...");
                    }, 2000);
                });
            }

            static decodeAncientScript(clue) {
                return new Promise((resolve, reject) => {
                    setTimeout(() => {
                        if (!clue) {
                            reject("没有线索可以解码!");
                        }

                        // 随机事件：30%几率遇到解码困难
                        if (Math.random() < 0.3) {
                            reject("糟糕！解码器出现了故障，需要寻找替代方法...");
                        } else {
                            resolve("解码成功!地图显示宝藏在一座名为'月光神庙'的古老建筑中，入口被藤蔓覆盖...");
                        }
                    }, 2500);
                });
            }

            static searchTemple(location) {
                return new Promise((resolve, reject) => {
                    setTimeout(() => {
                        const random = Math.random();
                        if (random < 0.4) {
                            reject("糟糕!遇到了神庙守卫!你不得不暂时撤退...");
                        } else if (random < 0.7) {
                            resolve("成功潜入神庙!在祭坛后面找到了一个神秘的箱子...");
                        } else {
                            // 特殊事件：发现隐藏通道
                            resolve("在躲避守卫时，你意外发现了一条隐藏通道!通道尽头有一个更加古老的宝箱...");
                        }
                    }, 3000);
                });
            }

            static openTreasureBox() {
                return new Promise((resolve) => {
                    setTimeout(() => {
                        // 随机宝藏类型
                        const treasures = [
                            "恭喜!你找到了传说中的'星辰之泪'宝石!",
                            "太棒了!宝箱里装满了古代金币和珠宝!",
                            "惊人发现!你找到了失传已久的'智慧之书'!",
                            "宝藏是一把镶嵌着宝石的古老钥匙，似乎能打开某个神秘之门..."
                        ];
                        const randomTreasure = treasures[Math.floor(Math.random() * treasures.length)];
                        resolve(randomTreasure);
                    }, 2000);
                });
            }

            // 新增方法：遇到随机事件
            static randomEvent() {
                return new Promise((resolve) => {
                    setTimeout(() => {
                        const events = [
                            "在路上你遇到了一位神秘的旅行者，他给了你一些有用的建议...",
                            "突然下起了暴雨，你不得不找个地方躲避，耽误了一些时间...",
                            "你发现了一条捷径，节省了不少时间!",
                            "你在路上捡到了一件有用的工具，可能会在后续探索中派上用场..."
                        ];
                        const randomEvent = events[Math.floor(Math.random() * events.length)];
                        resolve(randomEvent);
                    }, 1500);
                });
            }
        }

        // 用户管理组件
        const UserManagement = {
            template: `
                <div class="user-management">
                    <h2>用户管理</h2>
                    <div v-if="!currentUser" class="form-group">
                        <label>用户名</label>
                        <input type="text" v-model="username" placeholder="请输入用户名">
                        <button @click="login" style="margin-top: 15px; width: 100%;">登录/注册</button>
                    </div>
                    <div v-else>
                        <div class="user-info" style="justify-content: center; margin-bottom: 30px;">
                            <div class="avatar">{{ currentUser.avatar }}</div>
                            <div>
                                <h3>{{ currentUser.username }}</h3>
                                <p>注册时间: {{ formatDate(currentUser.registrationDate) }}</p>
                            </div>
                        </div>
                        
                        <div class="user-stats">
                            <div class="stat-card">
                                <div class="stat-value">{{ userStats.completedGames }}</div>
                                <div class="stat-label">完成游戏</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-value">{{ userStats.totalScore }}</div>
                                <div class="stat-label">总得分</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-value">{{ userStats.bestTime }}s</div>
                                <div class="stat-label">最快通关</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-value">{{ userStats.rank }}</div>
                                <div class="stat-label">当前排名</div>
                            </div>
                        </div>
                        
                        <button @click="logout" style="margin-top: 30px; width: 100%;">退出登录</button>
                    </div>
                </div>
            `,
            setup() {
                const username = ref('');
                const currentUser = ref(null);
                const userStats = ref({
                    completedGames: 0,
                    totalScore: 0,
                    bestTime: 0,
                    rank: 0
                });

                const login = () => {
                    if (username.value.trim()) {
                        // 模拟用户登录
                        currentUser.value = {
                            username: username.value,
                            avatar: username.value.charAt(0).toUpperCase(),
                            registrationDate: new Date()
                        };

                        // 模拟获取用户数据
                        userStats.value = {
                            completedGames: Math.floor(Math.random() * 20),
                            totalScore: Math.floor(Math.random() * 1000),
                            bestTime: Math.floor(Math.random() * 300),
                            rank: Math.floor(Math.random() * 100) + 1
                        };

                        username.value = '';
                    }
                };

                const logout = () => {
                    currentUser.value = null;
                };

                const formatDate = (date) => {
                    return date.toLocaleDateString('zh-CN');
                };

                return {
                    username,
                    currentUser,
                    userStats,
                    login,
                    logout,
                    formatDate
                };
            }
        };

        // 排行榜组件
        const Leaderboard = {
            template: `
                <div class="leaderboard">
                    <div class="leaderboard-header">
                        <h2>寻宝英雄榜</h2>
                        <p>看看谁是最厉害的寻宝者</p>
                    </div>
                    
                    <div class="leaderboard-list">
                        <div 
                            v-for="(user, index) in leaderboard" 
                            :key="user.id" 
                            class="leaderboard-item"
                            :class="'top-' + (index + 1)"
                        >
                            <div class="leaderboard-rank">{{ index + 1 }}</div>
                            <div class="leaderboard-user">
                                <div class="avatar">{{ user.avatar }}</div>
                                <div>
                                    <div>{{ user.username }}</div>
                                    <div style="font-size: 0.8rem; opacity: 0.7;">{{ user.region }}</div>
                                </div>
                            </div>
                            <div class="leaderboard-score">{{ user.score }} 分</div>
                        </div>
                    </div>
                </div>
            `,
            setup() {
                const leaderboard = ref([]);

                // 模拟排行榜数据
                const generateLeaderboard = () => {
                    const names = ['寻宝者', '冒险家', '探险家', '考古学家', '宝藏猎人', '神秘旅者'];
                    const regions = ['东方大陆', '西部荒野', '南方群岛', '北方雪原', '中央平原'];

                    return Array.from({ length: 10 }, (_, i) => ({
                        id: i + 1,
                        username: `${names[i % names.length]}${i + 1}`,
                        avatar: names[i % names.length].charAt(0),
                        region: regions[i % regions.length],
                        score: 1000 - i * 80 + Math.floor(Math.random() * 50)
                    })).sort((a, b) => b.score - a.score);
                };

                onMounted(() => {
                    leaderboard.value = generateLeaderboard();
                });

                return {
                    leaderboard
                };
            }
        };

        // 游戏进度组件
        const GameProgress = {
            template: `
                <div class="progress-container">
                    <div class="progress-bar">
                        <div class="progress" :style="{ width: progress + '%' }"></div>
                    </div>
                    <div class="progress-text">{{ progressText }}</div>
                </div>
            `,
            props: {
                progress: {
                    type: Number,
                    default: 0
                },
                progressText: {
                    type: String,
                    default: '准备开始寻宝...'
                }
            }
        };

        // 游戏步骤组件
        const GameStep = {
            template: `
                <div class="step-card" :class="stepClass">
                    <div class="step-header">
                        <div class="step-icon">{{ stepNumber }}</div>
                        <div class="step-title">{{ title }}</div>
                    </div>
                    <div class="step-content">
                        {{ content }}
                    </div>
                    <div class="step-status">{{ status }}</div>
                </div>
            `,
            props: {
                stepNumber: {
                    type: Number,
                    required: true
                },
                title: {
                    type: String,
                    required: true
                },
                content: {
                    type: String,
                    required: true
                },
                status: {
                    type: String,
                    default: '等待开始'
                },
                isActive: {
                    type: Boolean,
                    default: false
                },
                isCompleted: {
                    type: Boolean,
                    default: false
                },
                isFailed: {
                    type: Boolean,
                    default: false
                }
            },
            computed: {
                stepClass() {
                    return {
                        'active': this.isActive,
                        'completed': this.isCompleted,
                        'failed': this.isFailed
                    };
                }
            }
        };

        // 游戏日志组件
        const GameLog = {
            template: `
                <div class="event-log">
                    <h3>冒险日志</h3>
                    <div id="log-entries">
                        <div 
                            v-for="entry in logEntries" 
                            :key="entry.id" 
                            class="log-entry"
                            :style="{ color: entry.isError ? '#ff6b6b' : 'inherit' }"
                        >
                            [{{ entry.time }}] {{ entry.message }}
                        </div>
                    </div>
                </div>
            `,
            props: {
                logEntries: {
                    type: Array,
                    default: () => []
                }
            }
        };

        // 游戏结果组件
        const GameResult = {
            template: `
                <div class="treasure-result" v-if="show" :style="{ background: resultBackground }">
                    <div class="treasure-image">💎</div>
                    <h2>{{ title }}</h2>
                    <p>{{ description }}</p>
                </div>
            `,
            props: {
                show: {
                    type: Boolean,
                    default: false
                },
                success: {
                    type: Boolean,
                    default: false
                },
                title: {
                    type: String,
                    default: ''
                },
                description: {
                    type: String,
                    default: ''
                }
            },
            computed: {
                resultBackground() {
                    return this.success ? 'rgba(46, 204, 113, 0.3)' : 'rgba(231, 76, 60, 0.3)';
                }
            }
        };

        // 游戏主组件
        const TreasureGame = {
            template: `
                <div class="game-area">
                    <GameProgress :progress="progress" :progress-text="progressText" />
                    
                    <div class="steps-container">
                        <GameStep
                            v-for="step in steps"
                            :key="step.number"
                            :step-number="step.number"
                            :title="step.title"
                            :content="step.content"
                            :status="step.status"
                            :is-active="step.isActive"
                            :is-completed="step.isCompleted"
                            :is-failed="step.isFailed"
                        />
                    </div>
                    
                    <div class="controls">
                        <button @click="startAdventure" :disabled="isRunning">开始寻宝</button>
                        <button @click="resetGame" :disabled="!isRunning && progress === 0">重新开始</button>
                    </div>
                    
                    <GameResult
                        :show="showResult"
                        :success="gameSuccess"
                        :title="resultTitle"
                        :description="resultDescription"
                    />
                    
                    <GameLog :log-entries="logEntries" />
                </div>
            `,
            components: {
                GameProgress,
                GameStep,
                GameLog,
                GameResult
            },
            setup() {
                const progress = ref(0);
                const progressText = ref('准备开始寻宝...');
                const isRunning = ref(false);
                const showResult = ref(false);
                const gameSuccess = ref(false);
                const resultTitle = ref('');
                const resultDescription = ref('');
                const logEntries = ref([]);

                const steps = ref([
                    {
                        number: 1,
                        title: '寻找初始线索',
                        content: '在古老的图书馆中寻找关于宝藏的第一个线索...',
                        status: '等待开始',
                        isActive: false,
                        isCompleted: false,
                        isFailed: false
                    },
                    {
                        number: 2,
                        title: '解码古老文字',
                        content: '使用古老的解码器破译线索中的神秘文字...',
                        status: '尚未开始',
                        isActive: false,
                        isCompleted: false,
                        isFailed: false
                    },
                    {
                        number: 3,
                        title: '探索神庙',
                        content: '根据线索前往古老神庙，但要小心守卫...',
                        status: '尚未开始',
                        isActive: false,
                        isCompleted: false,
                        isFailed: false
                    },
                    {
                        number: 4,
                        title: '打开宝箱',
                        content: '找到神秘的宝箱并尝试打开它...',
                        status: '尚未开始',
                        isActive: false,
                        isCompleted: false,
                        isFailed: false
                    }
                ]);

                const totalSteps = computed(() => steps.value.length);

                const updateProgress = (step, text) => {
                    const newProgress = ((step - 1) / totalSteps.value) * 100;
                    progress.value = newProgress;
                    progressText.value = text;
                };

                const setStepActive = (stepNumber) => {
                    // 重置所有步骤状态
                    steps.value.forEach(step => {
                        step.isActive = false;
                    });

                    // 设置当前步骤为活动状态
                    const currentStep = steps.value.find(step => step.number === stepNumber);
                    if (currentStep) {
                        currentStep.isActive = true;
                        currentStep.status = '进行中...';
                    }
                };

                const setStepCompleted = (stepNumber) => {
                    const step = steps.value.find(step => step.number === stepNumber);
                    if (step) {
                        step.isActive = false;
                        step.isCompleted = true;
                        step.status = '完成!';
                    }
                };

                const setStepFailed = (stepNumber) => {
                    const step = steps.value.find(step => step.number === stepNumber);
                    if (step) {
                        step.isActive = false;
                        step.isFailed = true;
                        step.status = '失败!';
                    }
                };

                const addLog = (message, isError = false) => {
                    logEntries.value.push({
                        id: Date.now() + Math.random(),
                        time: new Date().toLocaleTimeString(),
                        message,
                        isError
                    });
                };

                const showGameResult = (success, title, description) => {
                    progress.value = 100;
                    progressText.value = success ? '寻宝成功!' : '寻宝失败';

                    gameSuccess.value = success;
                    resultTitle.value = title;
                    resultDescription.value = description;
                    showResult.value = true;
                };

                const resetGame = () => {
                    progress.value = 0;
                    progressText.value = '准备开始寻宝...';
                    isRunning.value = false;
                    showResult.value = false;
                    logEntries.value = [];

                    steps.value.forEach(step => {
                        step.isActive = false;
                        step.isCompleted = false;
                        step.isFailed = false;
                        step.status = step.number === 1 ? '等待开始' : '尚未开始';
                    });
                };

                const executeStep = async (stepNumber, statusText, stepFunction) => {
                    // 更新UI
                    updateProgress(stepNumber, statusText);
                    setStepActive(stepNumber);

                    try {
                        const result = await stepFunction();
                        setStepCompleted(stepNumber);
                        return result;
                    } catch (error) {
                        setStepFailed(stepNumber);
                        throw error;
                    }
                };

                const randomEvent = async () => {
                    // 50%几率触发随机事件
                    if (Math.random() < 0.5) {
                        addLog('随机事件发生...');
                        const event = await TreasureMap.randomEvent();
                        addLog('事件: ' + event);

                        // 添加一点延迟来模拟事件处理时间
                        await new Promise(resolve => setTimeout(resolve, 1000));
                    }
                };

                const startAdventure = async () => {
                    if (isRunning.value) return;

                    isRunning.value = true;
                    showResult.value = false;
                    logEntries.value = [];

                    try {
                        // 步骤1: 获取初始线索
                        await executeStep(1, '正在图书馆中寻找线索...', async () => {
                            const clue = await TreasureMap.getInitialClue();
                            addLog('找到了线索: ' + clue);
                            return clue;
                        });

                        // 随机事件
                        await randomEvent();

                        // 步骤2: 解码古老文字
                        await executeStep(2, '正在解码古老文字...', async () => {
                            const decoded = await TreasureMap.decodeAncientScript('地图线索');
                            addLog('解码结果: ' + decoded);
                            return decoded;
                        });

                        // 随机事件
                        await randomEvent();

                        // 步骤3: 探索神庙
                        await executeStep(3, '正在探索神庙...', async () => {
                            const templeResult = await TreasureMap.searchTemple('月光神庙');
                            addLog('神庙探索: ' + templeResult);
                            return templeResult;
                        });

                        // 随机事件
                        await randomEvent();

                        // 步骤4: 打开宝箱
                        await executeStep(4, '正在打开宝箱...', async () => {
                            const treasure = await TreasureMap.openTreasureBox();
                            addLog('宝箱内容: ' + treasure);
                            return treasure;
                        });

                        // 寻宝成功
                        showGameResult(true, '恭喜！寻宝成功！', '经过重重困难，你终于找到了传说中的宝藏！');

                    } catch (error) {
                        addLog('错误: ' + error, true);
                        showGameResult(false, '寻宝失败', '很遗憾，这次寻宝没有成功。原因: ' + error);
                    } finally {
                        isRunning.value = false;
                    }
                };

                return {
                    progress,
                    progressText,
                    isRunning,
                    showResult,
                    gameSuccess,
                    resultTitle,
                    resultDescription,
                    logEntries,
                    steps,
                    startAdventure,
                    resetGame
                };
            }
        };

        // 主应用组件
        const App = {
            template: `
                <div class="container">
                    <div class="navbar">
                        <div class="nav-brand">
                            <span>🏴‍☠️</span>
                            <span>Vue寻宝冒险</span>
                        </div>
                        <div class="nav-links">
                            <div 
                                v-for="page in pages" 
                                :key="page.id"
                                class="nav-link"
                                :class="{ active: currentPage === page.id }"
                                @click="switchPage(page.id)"
                            >
                                {{ page.name }}
                            </div>
                        </div>
                        <div class="user-info">
                            <div class="avatar">V</div>
                            <div>Vue探险家</div>
                        </div>
                    </div>
                    
                    <div class="page-container">
                        <TreasureGame v-if="currentPage === 'game'" />
                        <UserManagement v-else-if="currentPage === 'user'" />
                        <Leaderboard v-else-if="currentPage === 'leaderboard'" />
                    </div>
                </div>
            `,
            components: {
                TreasureGame,
                UserManagement,
                Leaderboard
            },
            setup() {
                const pages = [
                    { id: 'game', name: '寻宝游戏' },
                    { id: 'user', name: '用户管理' },
                    { id: 'leaderboard', name: '排行榜' }
                ];

                const currentPage = ref('game');

                const switchPage = (pageId) => {
                    currentPage.value = pageId;
                };

                return {
                    pages,
                    currentPage,
                    switchPage
                };
            }
        };

        // 创建Vue应用
        createApp(App).mount('#app');
    </script>
</body>

</html>